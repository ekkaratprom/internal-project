<div class="card">
  <form class="form-inline" [formGroup]="addCard" (ngSubmit)="onSubmit()">
    <div>
      <span class="close head" title="Exit" (click)="updateComplete()">&times;</span>
    </div>
    <div class="card-body" style="border: none">
      <h6>Create Card :</h6>
      <div class="card">
        <div class="card-body inner">
          <div class="assignment">Assignment</div>
          <div class="form-group mx-sm-3 mb-2">
            <div>
              <select class="form-control" id="input_assignment_id" formControlName="assignmentId"
                placeholder="choose your assignment">
                <option [ngValue]="null">choose your assignment</option>
                <option *ngFor="let c of rAssignmentList" value="{{ c.assignmentId }}">
                  {{ c.assignmentName }}
                </option>
              </select>
            </div>
          </div>

          <div class="form-group mx-sm-3 mb-2">
            <div class="txt cardd">Card</div>
            <!-- <div>Actual time</div> -->
            <label class="txt actualtime">Estimate Time per day</label>

            <input type="text" class="form-control" id="input_card_name" placeholder="type your card..."
              formControlName="cardName" />

            <input type="number" class="form-control" id="input_estimate_time" placeholder="0"
              formControlName="estimateTime" />
            <!-- <p>Actual Time</p> -->
            <div *ngIf="addCard.get('cardName').hasError('pattern')" class="error">
              Card name has invalid characters.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('max')" class="error">
              Estimate time must be 1 to 24.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('min')" class="error">
              Estimate time must be 1 to 24.
            </div>
          </div>

          <div class="btn-group" role="group" aria-label="Basic example">
            <button type="button" class="btn btn-secondary" (click)="calenderPicker(true)">
              one day
            </button>
            <button type="button" class="btn btn-secondary" (click)="calenderPicker(false)">
              Period time
            </button>
          </div>

          <div *ngIf="pickerDisplayDay == true">
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group">
                  <input class="form-control" placeholder="{{ selectDate | date: 'yyyy-MM-dd' }}" name="dp"
                    [(ngModel)]="dayPick" ngbDatepicker [footerTemplate]="footerTemplate" #d="ngbDatepicker" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"></button>
                  </div>
                </div>
              </div>
            </form>

            <ng-template #footerTemplate>
              <hr class="my-0" />
              <button class="btn btn-primary btn-sm m-2 float-left" (click)="dayPick = today; d.close()">
                Today
              </button>
              <button class="btn btn-secondary btn-sm m-2 float-right" (click)="d.close()">
                Close
              </button>
            </ng-template>

            <button [disabled]="addCard.status === 'INVALID'" type="submit" class="btn btn-primary bottom"
              (onClick)="onSubmit()">
              Submit
            </button>
          </div>

          <div *ngIf="pickerDisplayDay == false">
            <form class="form-inline">
              <div class="form-group hidden">
                <div class="input-group">
                  <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                    [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t"
                    outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" />
                  <ng-template #t let-date let-focused="focused">
                    <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                      [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                      (mouseleave)="hoveredDate = null">
                      {{ date.day }}
                    </span>
                  </ng-template>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <input #dpFromDate class="form-control" placeholder="yyyy-mm-dd" name="dpFromDate"
                    [value]="formatter.format(fromDate)" (input)="
                      fromDate = validateInput(fromDate, dpFromDate.value)
                    " />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                      type="button"></button>
                  </div>
                </div>
              </div>
              <div class="form-group ml-2">
                <div class="input-group">
                  <input #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                    [value]="formatter.format(toDate)" (input)="toDate = validateInput(toDate, dpToDate.value)" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                      type="button"></button>
                  </div>
                </div>
              </div>
            </form>

            <button [disabled]="addCard.status === 'INVALID'" type="submit" class="btn btn-primary bottom"
              (onClick)="onSubmitPeriod()">
              Submit
            </button>
          </div>

        </div>
      </div>
    </div>
  </form>
  <div>
    <div>
      <h6 class="card-list-header">Card List :</h6>
    </div>

    <div class="form-group mx-sm-3 mb-2 d-flex">
      <div *ngFor="let c of cardsData" class="card-list">
        <div class="card list" *ngFor="let item of c.card; index as i">
          <div class="row">
            <div class="bold col-5">Card name :</div>
            <div class="card-body listt col-7">
              {{ item.cardName }}
            </div>
          </div>
          <div class="row">
            <div class="bold col-5">Assignment name :</div>
            <div class="card-body listt col-7">
              {{ item.assignmentName }}
            </div>
          </div>
          <span class="close" (click)="updateDeleteStatus(item.cardId)" title="Delete Card">&times;</span>
          <form [formGroup]="editCard" (keydown)="keyDownFunction($event, item.cardId)">
            <label class="txt actualtime">Estimate</label>
            <input type="number" class="form-control editInput" id="input_card_estimate_time_{{ i }}" max="16"
              maxlength="2" placeholder="{{ item.estimateTime }}" formControlName="cardEstimateTime" />
            <label class="txt actualtime">Actualtime</label>
            <input type="number" class="form-control editInput" id="input_card_actual_time_{{ i }}" max="16"
              maxlength="2" placeholder="{{ item.actualTime }}" formControlName="cardActualTime" />
            <button class="btn btn-primary bottom editbtn" [disabled]="editCard.status === 'INVALID'"
              (click)="updateFunction(item.cardId)">
              Update
            </button>

            <div *ngIf="editCard.get('cardActualTime').hasError('max')" class="error">
              Actual time must be 1 to 24.
            </div>
            <div *ngIf="editCard.get('cardActualTime').hasError('min')" class="error">
              Actual time must be 1 to 24.
            </div>
          </form>
        </div>

        <div *ngIf="c.card.length > 0">
          <button class="btn btn-primary complete" (click)="updateComplete()">
            Update Complete
          </button>
        </div>
        <div *ngIf="c.card.length <= 0">Don't have card.</div>
      </div>
    </div>
  </div>
</div>