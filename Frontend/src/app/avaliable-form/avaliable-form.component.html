<div class="card">
  <form class="form-inline" [formGroup]="addCard" (ngSubmit)="onSubmit()">
    <div>
      <span class="close head" title="Exit" (click)="updateComplete()">&times;</span>
    </div>
    <div class="card-body" style="border: none">
      <h4 class="font-weight-bold mb-1 ">Create Card :</h4>
      <div class="card">


        <div *ngIf="resultAvaliable.totalEstimateTime < 8" class="card-body inner">
          <div class="assignment">Assignment</div>
          <div class="form-group mx-sm-3 mb-2">
            <div>
              <select class="form-control" id="input_assignment_id" formControlName="assignmentId"
                placeholder="choose your assignment">
                <option [ngValue]="null">choose your assignment</option>
                <option *ngFor="let c of rAssignmentList" value="{{ c.assignmentId }}">
                  {{ c.assignmentName }}
                </option>
              </select>
            </div>
          </div>

          <div class="form-group mx-sm-3 mb-2">
            <div class="txt cardd mt-2 mb-1">Card</div>
            <!-- <div>Actual time</div> -->
            <label class="txt actualtimetop mt-2 mb-1">Estimate Time per day</label>

            <input type="text" class="form-control" id="input_card_name" placeholder="type your card..."
              formControlName="cardName" />


            <input type="number" class="form-control" id="input_estimate_time" placeholder="0"
              formControlName="estimateTime" (keyup)="estimateValidate($event)" />
            <!-- <p>Actual Time</p> -->

            <div *ngIf="addCard.get('cardName').hasError('pattern')" class="error">
              Card name has invalid characters.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('max')" class="error">
              Estimate time must be 1 to 8.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('min')" class="error">
              Estimate time must be 1 to 8.
            </div>
            <div *ngIf="estimateStatus == true" class="error">
              Total estimate time must not over than 8 hrs. per day.
            </div>
          </div>

          <div class="btn-group mt-3 mb-2" role="group" aria-label="Basic example">

            <button [ngClass]="{'btn-primary' : pickerDisplayDay, 'btn-secondary' : !pickerDisplayDay }" type="button"
              class="btn " (click)="calenderPicker(true)">

              One day
            </button>
            <button type="button" [ngClass]="{'btn-secondary' : pickerDisplayDay, 'btn-primary' : !pickerDisplayDay }"
              class="btn " (click)="calenderPicker(false)">
              Period time
            </button>
          </div>
          <label for="date" class="date-txt mt-1 mb-1">Date</label>

          <div *ngIf="pickerDisplayDay">
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group">

                  <br>
                  <input id="date" class="form-control" placeholder="{{ selectDate | date: 'yyyy-MM-dd' }}" name="dp"
                    [(ngModel)]="dayPick"  [markDisabled]="markDisabled" ngbDatepicker [footerTemplate]="footerTemplate" #d="ngbDatepicker"/>
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"></button>
                  </div>
                </div>
              </div>
            </form>

            <ng-template #footerTemplate>
              <hr class="my-0" />
              <button class="btn-width btn btn-primary btn-sm m-2 float-left" (click)="dayPick = today; d.close()">
                Today
              </button>
              <button class="btn-width btn btn-secondary btn-sm m-2 float-right" (click)="d.close()">
                Close
              </button>
            </ng-template>

          </div>

          <div *ngIf="!pickerDisplayDay">
            <form class="form-inline">
              <div class="form-group hidden">
                <div class="input-group">
                  <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                    [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t"
                    outsideDays="hidden" [startDate]="fromDate!" tabindex="-1"  [markDisabled]="markDisabled"/>
                  <ng-template #t let-date let-focused="focused">
                    <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                      [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                      (mouseleave)="hoveredDate = null">
                      {{ date.day }}
                    </span>
                  </ng-template>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <input #dpFromDate class="form-control"   placeholder="yyyy-mm-dd" name="dpFromDate"
                    [value]="formatter.format(fromDate)" (input)="
                      fromDate = validateInput(fromDate, dpFromDate.value)
                    " />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                      type="button"></button>
                  </div>
                </div>
              </div>
              <div class="form-group ml-2">
                <div class="input-group">
                  <input #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                    [value]="formatter.format(toDate)" (input)="toDate = validateInput(toDate, dpToDate.value)" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                      type="button"></button>
                  </div>
                </div>
              </div>


            </form>


          </div>

          <button [disabled]="addCard.status === 'INVALID'" type="submit" class="btn btn-primary bottom"
            (onClick)="onSubmit()">
            Submit
          </button>

        </div>


        <div *ngIf="resultAvaliable.totalEstimateTime >= 8" class="card-body inner">
          <div class="assignment">Assignment</div>
          <div class="form-group mx-sm-3 mb-2">
            <div>
              <select class="form-control" id="input_assignment_id" formControlName="assignmentId"
                placeholder="choose your assignment" disabled>
                <option [ngValue]="null">choose your assignment</option>
                <option *ngFor="let c of rAssignmentList" value="{{ c.assignmentId }}">
                  {{ c.assignmentName }}
                </option>
              </select>
            </div>
          </div>

          <div class="form-group mx-sm-3 mb-2">
            <div class="txt cardd mt-2 mb-1">Card</div>
            <!-- <div>Actual time</div> -->
            <label class="txt actualtimetop mt-2 mb-1">Estimate Time per day</label>

            <input type="text" class="form-control" id="input_card_name" placeholder="type your card..."
              formControlName="cardName" disabled />

            <input type="number" class="form-control" id="input_estimate_time" placeholder="0"
              formControlName="estimateTime" disabled />
            <!-- <p>Actual Time</p> -->
            <div *ngIf="addCard.get('cardName').hasError('pattern')" class="error">
              Card name has invalid characters.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('max')" class="error">
              Estimate time must be 1 to 24.
            </div>
            <div *ngIf="addCard.get('estimateTime').hasError('min')" class="error">
              Estimate time must be 1 to 24.
            </div>
          </div>

          <div class="btn-group mt-3 mb-2" role="group" aria-label="Basic example">

            <button [ngClass]="{'btn-primary' : pickerDisplayDay, 'btn-secondary' : !pickerDisplayDay }" type="button"
              class="btn " (click)="calenderPicker(true)" disabled>

              One day
            </button>
            <button type="button" [ngClass]="{'btn-secondary' : pickerDisplayDay, 'btn-primary' : !pickerDisplayDay }"
              class="btn " (click)="calenderPicker(false) " disabled>
              Period time
            </button>
          </div>
          <label for="date" class="date-txt mt-1 mb-1">Date</label>

          <div *ngIf="pickerDisplayDay">
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group">

                  <br>
                  <input id="date" class="form-control" placeholder="{{ selectDate | date: 'yyyy-MM-dd' }}" name="dp"
                    [(ngModel)]="dayPick" ngbDatepicker [footerTemplate]="footerTemplate" #d="ngbDatepicker" disabled />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"
                      disabled></button>
                  </div>
                </div>
              </div>
            </form>

            <ng-template #footerTemplate>
              <hr class="my-0" />
              <button class="btn-width btn btn-primary btn-sm m-2 float-left" (click)="dayPick = today; d.close()">
                Today
              </button>
              <button class="btn-width btn btn-secondary btn-sm m-2 float-right" (click)="d.close()">
                Close
              </button>
            </ng-template>

          </div>

          <div *ngIf="!pickerDisplayDay">
            <form class="form-inline">
              <div class="form-group hidden">
                <div class="input-group">
                  <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                    [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t"
                    outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" disabled />
                  <ng-template #t let-date let-focused="focused">
                    <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                      [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                      (mouseleave)="hoveredDate = null">
                      {{ date.day }}
                    </span>
                  </ng-template>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <input #dpFromDate class="form-control" placeholder="yyyy-mm-dd" name="dpFromDate"
                    [value]="formatter.format(fromDate)" (input)="
                      fromDate = validateInput(fromDate, dpFromDate.value)
                    " disabled />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()" type="button"
                      disabled></button>
                  </div>
                </div>
              </div>
              <div class="form-group ml-2">
                <div class="input-group">
                  <input #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                    [value]="formatter.format(toDate)" (input)="toDate = validateInput(toDate, dpToDate.value)"
                    disabled />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()" type="button"
                      disabled></button>
                  </div>
                </div>
              </div>


            </form>


          </div>

          <button [disabled]="addCard.status === 'INVALID'" type="submit" class="btn btn-primary bottom"
            (onClick)="onSubmit()">
            Submit
          </button>



          <div class="d-flex justify-content-center max-hour-error">
            Maximum Hours.
          </div>

        </div>



      </div>
    </div>
  </form>
  <div>
    <div>
      <h4 class="font-weight-bold ml-4 mb-0 mt-5">Card List :</h4>
    </div>

    <div class="form-group mx-sm-3 mb-2 d-flex">
      <div *ngFor="let c of cardsData" class="card-list">
        <div class="card list  mt-3 mb-3" *ngFor="let item of c.card; index as i">
          <div class="row mt-3">
            <div class="bold col-5 ">Card name :</div>
            <div class="card-body listt col-7">
              {{ item.cardName }}
            </div>
          </div>
          <div class="row">
            <div class="bold col-5">Assignment name :</div>
            <div class="card-body listt col-7">
              {{ item.assignmentName }}
            </div>
          </div>
          <span class="close" (click)="openclosemodal(content1) ;" title="Delete Card">&times;</span>


          <ng-template #content1 let-modal>
            <div class="modal-header">
              <h4 class="modal-title closemodal-bold" id="modal-basic-title ">Delete confirmation</h4>

              <span (click)="modal.dismiss('Cross click')" class="closemodal" aria-hidden="false">&times;</span>

            </div>
            <div class="modal-body">
              Do you want to Delete <span class="closemodal-bold">{{ item.cardName }} </span> Card?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn-closemodal  btn-outline-dark"
                (click)="modal.close('Save click')">Cancel</button>
              <button type="button" class="btn-closemodal  btn-outline-primary"
                (click)="updateDeleteStatus(item.cardId); modal.dismiss('Cross click')">Ok</button>
            </div>

          </ng-template>

          <form [formGroup]="editCard" (keydown)="keyDownFunction($event, item.cardId)">
            <div class="row mb-4">
              <div class="row">
                <div class="txt estiamtetime mb-2">Estimate time</div>
                <input type="number" class="form-control editInput" id="input_card_estimate_time_{{ i }}" max="8"
                  maxlength="2" placeholder="{{ item.estimateTime }}" formControlName="cardEstimateTime"
                  (keyup)="cardEstimateValidate($event,item.estimateTime,item.cardId)" />
              </div>
              <div class="row">
                <label class="txt actualtime mb-2">Actual time</label>
                <input type="number" class="form-control ml " id="input_card_actual_time_{{ i }}" max="24" maxlength="2"
                  placeholder="{{ item.actualTime }}" formControlName="cardActualTime"
                  (keyup)="cardActualValidate($event,item.cardId)"/>
              </div>
              <button class="btn btn-primary bottom editbtn" [disabled]="editCard.status === 'INVALID'"
                (click)="updateFunction(item.cardId)">
                Update
              </button>

              <div *ngIf="editCard.get('cardActualTime').hasError('max') && item.cardId == cardActualId" class="error">
                Actual time must be 1 to 24.
              </div>
              <div *ngIf="editCard.get('cardActualTime').hasError('min') && item.cardId == cardActualId" class="error">
                Actual time must be 1 to 24.
              </div>
              <div *ngIf="editCard.get('cardEstimateTime').hasError('max')" class="error">
                Estimate time must be 1 to 8.
              </div>
              <div *ngIf="editCard.get('cardEstimateTime').hasError('min')" class="error">
                Estimate time must be 1 to 8.
              </div>
              <div *ngIf="cardEstimateStatus == true && item.cardId == cardId" class="error">
                Total estimate time must not over than 8 hrs. per day.
              </div>

            </div>



          </form>
        </div>

        <div *ngIf="c.card.length > 0">
          <button class="btn btn-primary complete" (click)="updateComplete()">
            Update Complete
          </button>
        </div>
        <div *ngIf="c.card.length <= 0">Don't have card.</div>
      </div>
    </div>
  </div>
</div>
