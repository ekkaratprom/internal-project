<div for="search-text" class="assignment-header">Assignment</div>
<div class="assignment-part">
  <div class="assignmentsearch">
    <div class="form-group">
      <input
        type="text"
        class="form-control search"
        id="search-text"
        [(ngModel)]="assignmentsearchText"
        placeholder="All Assignment"
      />
    </div>

    <select class="form-control complete" [(ngModel)]="completedStatusCheck">
      <option [ngValue]="undefined">All</option>
      <option [ngValue]="true">Complete</option>
      <option [ngValue]="false">Incomplete</option>
    </select>
  </div>

  <ng-template #content let-modal>
    <app-assignment-form
      (submitCompleted)="close(); submit()"
    ></app-assignment-form>
  </ng-template>
  <button (click)="open(content)" class="btn btn-lg me-btn-add">
    + assignment
  </button>

  <ul class="list-group list-group-flush">
    <li class="list-group-item">
      <div
        class="card"
        *ngFor="
          let r of result
            | completedstatusFilter: completedStatusCheck
            | assignmentFilter: assignmentsearchText;
          index as i
        "
      >
        <div class="card-body">
          <p class="card-text text" style="font-weight: bold">
            <mat-icon
              class="icon-complete"
              title="{{ r.completedStatus | titlecompletedStatusPipe }}"
              (click)="toggle(i, r.assignmentId, r.completedStatus)"
              [ngStyle]="{
                color:
                  r.completedStatus
                  | colorcompletedStatusPipe: r.completedStatus
              }"
              >check_circle</mat-icon
            >
            {{ r.assignmentName }}

            <span class="close" (click)="updateDeleteStatus(r.assignmentId)"
              >&times;</span
            >
          </p>

          <hr class="solid" />

          <div *ngIf="compareMoreThanEndDate(r.endDate) == true">
            <div>Today {{ today | date: "yMMdd" }}</div>
            <div>r.endDate {{ r.endDate | date: "yMMdd" }}</div>

            <div class="progress1">
              <span>Progress :</span>
              <span class="progress-bar1">
                <mat-progress-bar
                  [color]="colorwarn"
                  mode="determinate"
                  value="{{ (r.totalActualTime / r.estimateTime) * 100 }}"
                >
                </mat-progress-bar>
              </span>
            </div>
          </div>

          <div *ngIf="compareMoreThanEndDate(r.endDate) == false">
            <div class="progress1">
              <span>Progress :</span>
              <span class="progress-bar1">
                <mat-progress-bar
                  [color]="colorprim"
                  mode="determinate"
                  value="{{ (r.totalActualTime / r.estimateTime) * 100 }}"
                >
                </mat-progress-bar>
              </span>
            </div>
          </div>

          <div>End date : {{ r.endDate | date: "dd/MM/yyyy" }}</div>

          <div class="d-flex" title="billable time">
            <div class="icon-time">
              <div class="d-flex child">
                <i class="material-icons md-18">ic_monetization_on</i>
                <p>
                  <!-- Billable Time: -->
                  {{ r.billableTime }} Hrs
                </p>
              </div>

              <div class="d-flex child" title="estimate time">
                <i class="material-icons md-18">ic_query_builder</i>
                <p>
                  <!-- Estimate Time: -->
                  {{ r.estimateTime }} Hrs
                </p>
              </div>

              <div *ngIf="r.totalActualTime == null || r.totalActualTime == 0">
                <div class="d-flex child" title="actual time">
                  <i class="material-icons md-18">ic_watch_later</i>
                  <p>
                    <!-- Actual Time: -->
                    0 Hr
                  </p>
                </div>
              </div>

              <div *ngIf="r.totalActualTime !== null || r.totalActualTime >= 0">
                <div class="d-flex child" title="actual time">
                  <i class="material-icons md-18">ic_watch_later</i>
                  <p>
                    <!-- Actual Time: -->
                    {{ r.totalActualTime }} Hrs
                  </p>
                </div>
              </div>
            </div>


            <div *ngIf="r['cardObj'].length > 0">
              <button
                (click)="r.isCollapsed = !r.isCollapsed"
                [attr.aria-expanded]="!r.isCollapsed"
                aria-controls="collapseExample"
                class="dropdown"
              >
                <mat-icon class="fa" aria-hidden="true" class="cursor"
                  >expand_more</mat-icon
                >
              </button>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-12">
              <div></div>

              <div [ngbCollapse]="r.isCollapsed">
                <div class="row">
                  <p class="row">Card</p>
                  <p class="row">Date</p>
                  <p class="row">Actual Time</p>
                </div>
                <div *ngFor="let co of r['cardObj']" class="row subcard">
                  <p class="row mt-2 mb-2">{{ co.cardName }}</p>
                  <p class="row mt-2 mb-2">
                    {{ co.cardDate | date: "dd/MM/yyyy" }}
                  </p>
                  <p class="row mt-2 mb-2">{{ co.cardActualTime }} Hrs.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </li>
  </ul>
</div>
